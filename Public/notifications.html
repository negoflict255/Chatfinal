<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
      integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="css/style.css" />
    <title>Notifications</title>
  </head>
  <body>
    <div style="display: flex; justify-content: center">
      
    </div>
    <div class="join-container">
      <header class="join-header">
        <h1 ><i><img src="assets/logo.jpg"
        width="80" height="90" alt="webmaster logo" /></i>Notifications </h1>
      </header>
    <center>  <h2 style="background-color: rgb(255, 255, 255); color: darkblue;">Please check notifications you have read</h2></center>
    

      <h1 id="data"  style="background-color: rgb(255, 255, 255); color: #000;">
        


        <script>
          function read(id, negoid ){
            src="https://smtpjs.com/v3/smtp.js"
            const yourUrl = '/api/read'
            const object = { //put here relavent
              id:id
                          }
            var xhr = new XMLHttpRequest();
            xhr.open("POST", yourUrl, true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.send(JSON.stringify(object));
            alert("The message has been read ");
            window.location.href="notifications.html";
          }
          </script>


      <script>
          
        const username = localStorage.getItem("username");

        const yourUrl = "/api/getnot/" + username;

        fetch(yourUrl)
          .then(res=>res.json())
          .then((res) => {
            var strHtml = "";
            var myarray = res;
            console.log("check");
            console.log(myarray);
            if(myarray.length===0)
            {
              strHtml += /*html*/`<div><center>
                <h5>
                You have no new notifications</h5>
                `;
            }
            
            myarray.forEach((obj) => {
            let {id, conent } = obj;
            strHtml += /*html*/`<div>
                <div>
                  <h6>#${conent}
                  <button type="submit"  style="color:white" onclick="read('${id}');"><img src="https://cdns.iconmonstr.com/wp-content/assets/preview/2018/240/iconmonstr-checkbox-checked-thin.png" width="20"></button></h6>
                  <br>
                </div>
              </div>`;
            });

            console.log(strHtml);
            document.getElementById("data").innerHTML = strHtml;
          });
        </script>
        
    
    
  
            <button type="submit" class="btn">Submit</button>
          </a>
        </div>
      </main>
    </div>
  </body>
  <center> <a href="index.html">
    <button>Logout</button></a></center>
</html>
